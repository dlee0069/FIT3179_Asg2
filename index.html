<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/vega@5.25.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.15.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.22.2"></script>
  <style>
        .vis {
            margin: 40px 0;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body style="font-family: Arial, sans-serif; text-align: center; background-color: #000D2C;">
  <h1 style="color: #00FFD0; font-weight: bold;">Global Broadband Speed</h1>
  <p style="color: #FFFFFF;">This immersive experience takes you on a journey across continents, exploring the varying speeds at which people around the world connect to the internet</p>
  <div class="vis" id="map"></div>

  <p style="color: #FFFFFF;">Compare the broadband speed between countries filtered by continents</p>
  <div class="vis" id="bar"></div>
    
  <script>
    const map = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 1000,
  "height": 450,
  "projection": {"type": "equalEarth"},
  "data": {
    "url": "https://raw.githubusercontent.com/dlee0069/FIT3179_Asg2/main/ne_110m_admin_0_countries.json",
    "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
  },
  "transform": [
    {
      "lookup": "properties.NAME",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/dlee0069/FIT3179_Asg2/main/internet%20broadband%20and%20mobile%20speeds%20by%20country.csv"
        },
        "key": "Country",
        "fields": ["Broadband Mbps"]
      },
      "default": "0"
    }
  ],
  "mark": {"type": "geoshape", "stroke": "black", "strokeWidth": 0.05},
  "encoding": {
    "color": {"field": "Broadband Mbps", "type": "quantitative" },
    "tooltip": [
      {"field": "properties.NAME", "type": "nominal", "title": "Country"},
      {"field": "Broadband Mbps", "type": "quantitative"}
    ]
  }
};

    var bar = {
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/dlee0069/FIT3179_Asg2/main/internet%20broadband%20and%20mobile%20speeds%20by%20country.csv"
  },
  "params": [
    {
      "name": "Continent_filter",
      "bind": {
        "name": "Continent filter: ",
        "input": "select",
        "options": ["Asia", "Africa", "North America", "South America", "Europe", "Oceania"]
      }, "value": "Asia"
    }
  ],
  "layer": [
    {
      "mark": "bar",
      "encoding": {
        "y": {"field": "Broadband Mbps", "type": "quantitative", "title": "Broadband Mbps"},
        "x": {"field": "Country", "type": "nominal", "title": "", "sort": "-y"},
        "color": {
          "field": "Continent",
          "type": "nominal",
          "scale": {
            "domain": ["Asia", "Africa", "North America", "South America", "Europe", "Oceania"],
            "range": ["darkblue", "green", "brown", "lightblue", "orange", "purple"]
          }
        },
        "tooltip": [
          {"field": "Broadband Speed Rank", "type": "nominal", "title": "Rank: "},
          {"field": "Country", "type": "nominal", "title": "Country: "},
          {"field": "Broadband Mbps", "type": "quantitative", "title": "Broadband Mbps: "}
        ]
      }
    },
    {
      "mark": {"type": "rule", "color": "red", "strokeWidth": 2},
      "encoding": {
        "y": {"field": "Broadband Mbps", "type": "quantitative", "aggregate": "average"}
      }
    },
    {
      "mark": {"type": "text", "dy": -10},
      "encoding": {
        "y": {"field": "Broadband Mbps", "type": "quantitative", "aggregate": "average"},
        "text": {"field": "Broadband Mbps", "type": "quantitative", "format": ".2f", "aggregate": "average"}
      }
    }
  ],
  "transform": [
    {"filter": "datum.Continent == Continent_filter"}
  ]
};
    
    vegaEmbed("#map", map);
    vegaEmbed("#bar", bar);
  </script>
</body>
</html>
